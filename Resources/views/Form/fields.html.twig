{% block ecommit_javascript_select2entityajax_widget %}
    {% spaceless %}
        {{ form_widget(form) }}
        <script type="text/javascript">
            $(function() {
                $("#{{ id }}").select2({
                    minimumInputLength: {{ min_chars }},
                    placeholder: '{{ place_holder }}',
                    allowClear: true,
                    ajax: {
                        url: "{{ url }}",
                        dataType: 'json',
                        data: function (term, page) {
                            return {
                                term: term,
                                page: page
                            }
                        },
                        results: function (data, page) {
                            var more = page < data.totalPages;

                            return {results: data.results, more: more };
                        }
                    },
                    formatResult: function (data) {
                        return data.label;
                    },
                    formatSelection: function (data) {
                        return data.label;
                    },
                    id: function(bond){ return bond.key; },
                    initSelection : function (element, callback) {
                        var text = $(element).attr('data-selected-data');
                        var data = {key: element.val(), label: text};
                        callback(data);
                    },
                    width: "350px"
                });
            });
        </script>
    {% endspaceless %}
{% endblock %}

{% block ecommit_javascript_select2entity_widget %}
    {% spaceless %}
        {{ form_widget(form) }}
        {{ block('ecommit_javascript_select2_js') }}
    {% endspaceless %}
{% endblock %}

{% block ecommit_javascript_select2_js %}
    <script type="text/javascript">
        $(function() {
            $("#{{ id }}").select2({
                placeholder: '{{ place_holder }}',
                allowClear: true,
                width: "350px"
            });
        });
    </script>
{% endblock %}